自分で再実装したコードです
